=pod

=encoding utf8

=head1 NAME

Bot::ChatBots::Guard - Simple guard class

=head1 SYNOPSIS

   use Bot::ChatBots::Guard;

   {
      my $guard = Bot::ChatBots::Guard->new(sub { print 'whatever' });
   }
   # 'whatever' is printed here

   {
      my $guard = Bot::ChatBots::Guard->new(sub { print 'whatever' });
      # ... do stuff...
      $guard->release; # 'whatever' is printed here
   }
   # nothing is printed here


=head1 DESCRIPTION

This class implements a simple (lexical) guard mechanism for firing up
some cleanup code at the end of the scope (or anyway when the variable
hits a reference counting of 0 and the destructor is called).

Be careful that using it with closed-over variables can create loops that
might prevent correct operation of the guard.

=head1 METHODS

=head2 B<< DESTROY >>

Destructor, you are not supposed to call it directly. If you do, it will
actually just call L</release> behind the scenes.

=head2 B<< new >>

   my $guard = Bot::ChatBots::Guard->new($subref);

Create a new guard object and set the associated subroutine reference,
which will be called when the variable will exit the current scope (or in
any case hit zero reference counting, if it is closed over).

The easiest way to get a new guard object is probably the convenience
function L<Bot::ChatBots::Utils/guard> though.

=head2 B<< release >>

   $guard->release;

Release the guard, calling the sub reference set at creation. The sub will
be only called once, so calling this method multiple times actually does
nothing from the second time on.

=head1 SEE ALSO

L<Bot::ChatBots>, L<Bot::ChatBots::Utils/guard>.

=head1 AUTHOR

Flavio Poletti <polettix@cpan.org>

=head1 COPYRIGHT AND LICENSE

Copyright (C) 2016 by Flavio Poletti <polettix@cpan.org>

This module is free software. You can redistribute it and/or modify it
under the terms of the Artistic License 2.0.

This program is distributed in the hope that it will be useful, but
without any warranty; without even the implied warranty of
merchantability or fitness for a particular purpose.

=cut
